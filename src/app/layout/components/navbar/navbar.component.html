<nav
  class="bg-white/70 border-b border-gray-200/50 px-4 py-3 dark:bg-gray-900/80 dark:border-gray-700/50 fixed left-0 right-0 top-0 z-50"
>
  <div class="flex flex-wrap justify-between items-center relative">
    <!-- Efecto de resplandor sutíl -->
    <div
      class="absolute inset-0 bg-gradient-to-r from-blue-500/10 via-transparent to-blue-500/10 dark:from-blue-400/10 dark:to-blue-400/10 blur-xl opacity-50"
    ></div>
    <div class="flex justify-start items-center gap-3 z-10">
      <button
        (click)="toggleSidebar.emit()"
        class="relative p-2 rounded-lg hover:bg-white/90 dark:hover:bg-gray-800 transition-all duration-200 hover:shadow-lg group"
      >
        <!-- Menú Icon -->
        @if (sidebarOpen()) {
        <svg
          class="text-gray-800 dark:text-white transform transition-transform duration-200 group-hover:scale-110 group-hover:rotate-90"
          aria-hidden="true"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          fill="none"
          viewBox="0 0 24 24"
        >
          <path
            stroke="currentColor"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
        } @else {
        <svg
          class="text-gray-800 dark:text-white transform transition-transform duration-200 group-hover:scale-110"
          aria-hidden="true"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          fill="none"
          viewBox="0 0 24 24"
        >
          <path
            stroke="currentColor"
            stroke-linecap="round"
            stroke-width="2"
            d="M5 7h14M5 12h14M5 17h14"
          />
        </svg>
        }

        <!-- Close Icon -->
      </button>

      <a routerLink="dashboard" class="flex items-center gap-3 group">
        <div class="relative">
          <!-- Reemplazamos logo-app por un logo temporal -->
          <div
            class="w-8 h-8 rounded-lg text-white font-bold transition-transform duration-300 group-hover:scale-110 group-hover:rotate-3"
          >
            <logo-app></logo-app>
          </div>
          <!-- Efecto de brillo detrás del logo -->
          <div
            class="absolute inset-0 bg-blue-500/20 rounded-lg blur-md transform scale-110 opacity-0 group-hover:opacity-100 transition-transform duration-300"
          ></div>
        </div>
        <span
          class="self-center text-xl font-semibold whitespace-nowrap text-gray-800 dark:text-white transition-colors duration-200 group-hover:text-blue-600 dark:group-hover:text-blue-400 relative"
        >
          FinZenApp
          <!-- Línea de subrayado animada -->
          <span
            class="absolute bottom-0 left-0 w-0 h-0.5 bg-blue-500/50 group-hover:w-full transition-transform duration-300"
          ></span>
        </span>
      </a>
    </div>

    <div class="flex items-center gap-2 z-10">
      <!-- Theme Toggle Button -->
      <button
        (click)="toggleTheme()"
        class="relative p-2 rounded-lg hover:bg-white/90 dark:hover:bg-gray-800 transition-all duration-200 hover:shadow-lg text-gray-600 dark:text-gray-400"
        [title]="isDarkMode() ? 'Cambiar a tema claro' : 'Cambiar a tema oscuro'"
      >
        <!-- Sun Icon (Light Mode) -->
        <svg
          *ngIf="!isDarkMode()"
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
          />
        </svg>
        <!-- Moon Icon (Dark Mode) -->
        <svg
          *ngIf="isDarkMode()"
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
          />
        </svg>
      </button>

      <!-- Notifications Button -->
      <button
        (click)="isUserNotificationOpen.set(true)"
        class="relative p-2 rounded-lg hover:bg-white/90 dark:hover:bg-gray-800 transition-all duration-200 hover:shadow-lg text-gray-600 dark:text-gray-400"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"
          />
        </svg>
        <!-- Badge de notificaciones no leídas -->
        <!-- @if (unreadNotificationsCount() > 0) {
          <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center animate-pulse">
            {{unreadNotificationsCount() > 99 ? '99+' : unreadNotificationsCount()}}
          </span>
        } -->
      </button>

      <div
        class="w-px h-7 bg-gradient-to-b from-gray-200/50 via-gray-300/50 to-gray-200/50 dark:from-gray-700/50 dark:via-gray-600/50 dark:to-gray-700/50 rounded-full"
      ></div>

      <button
        (click)="onUserClick()"
        class="relative  rounded-lg hover:bg-white/90 dark:hover:bg-gray-800 transition-all duration-200 hover:shadow-lg overflow-hidden"
      >
        @if (profileImageService.hasSafePhotoUrl()) {
          <img 
            [src]="profileImageService.getSafePhotoUrl()" 
            (error)="profileImageService.handleImageError()"
            alt="Avatar del usuario"
            class="w-7 h-7 rounded-full object-cover"
          >
        } @else {
          <!-- Icono de usuario por defecto -->
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="w-5 h-5 text-gray-600 dark:text-gray-400"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
          />
        </svg>}
      </button>
    </div>
  </div>
</nav>

<!-- Sidebar de perfil de usuario usando el nuevo componente side-sheet -->
 @if (isUserSidebarOpen()) {
<app-side-sheet 
  [isOpen]="isUserSidebarOpen()" 
  [position]="'right'"
  (closeSheet)="closeUserSidebar()">
  <app-user-profile-sidebar 
    (closeSidebar)="closeUserSidebar()"
  ></app-user-profile-sidebar>
</app-side-sheet>

 }


<!-- Sidebar de notificaciones usando el nuevo componente side-sheet -->


@if (isUserNotificationOpen()) {
  <app-side-sheet 
  [isOpen]="isUserNotificationOpen()" 
  [position]="'right'"
  (closeSheet)="closeNotificationSidebar()">
  <app-user-notification-sidebar 
    (closeUserSidebar)="closeNotificationSidebar()"
  ></app-user-notification-sidebar>
</app-side-sheet>

}